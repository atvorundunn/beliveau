#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Apr 22 18:06:28 2020

@author: Alisa
"""
#inputFile = '/Users/Alisa/Downloads/hg38.hybrid.vcf'
#varBed = '/Users/Alisa/Documents/bedLike.txt'


def main():
    inputFile = input("Please provide file name for variant list: ")
    
    bpList = filter_bps(inputFile)
    
    varBed = listToBedLike(bpList)
    
    #sect = Something with bedtools
    
def filter_bps(inputFile):
    # Read in file contents.
    with open(inputFile, 'r') as f:
        file_read = [line.strip() for line in f]
    
    
    # Create filtered list using conditional list comprehension.
    filtered_list = [x for x in file_read if x.split('\t')[0][0:3]=="chr" \
                     and len(x.split('\t')[3])==1 and len(x.split('\t')[4])==1]
    
    bpList = []
    
    for x in range(len(filtered_list) - 1):
        if filtered_list[x].split('\t')[9] == "0|1" or filtered_list[x].split('\t')[9] == "1|0":
            bpList.append(filtered_list[x])

    print('Program returned %d / %d lines after filtering' % \
          (len(bpList), len(file_read)))
        
    return bpList
    

def listToBedLike(bpList):
    varBed = input("Where would you like to write the filtered variant list: ")
    w = open('/Users/Alisa/Documents/bedLike.txt', 'w')

    chrX_start = 2122646
    chrX_end = 2188636  
    
    for x in range(chrX_start, chrX_end, 1):
        s1 = bpList[x].split('\t')[0]
        d1 = int(bpList[x].split('\t')[1])
        d2 = int(bpList[x].split('\t')[1]) + 1
        s2 = bpList[x].split('\t')[3]
        s3 = bpList[x].split('\t')[4]
        w.write("%s \t %d \t %d\t %s \t %s \n" % (s1, d1, d2, s2, s3))
        
    return varBed
